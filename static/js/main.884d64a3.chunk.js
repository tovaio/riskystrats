(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{30:function(e,t,n){e.exports=n(69)},35:function(e,t,n){},64:function(e,t){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var o,a=n(0),r=n.n(a),c=n(28),d=n.n(c),l=(n(35),n(12)),i=n(29),s=n.n(i);n(67);!function(e){e[e.Normal=0]="Normal",e[e.Factory=1]="Factory",e[e.PowerPlant=2]="PowerPlant",e[e.Fort=3]="Fort",e[e.Artillery=4]="Artillery"}(o||(o={}));var u,m=["#444444","#DD0000","#00DD00","#0000DD","#DD00DD"],y=function(e){var t=e.visible?m[e.team]:m[0],n=e.visible?"#eeeeee":m[0],a=e.selectedNodeID>=0&&e.visible||e.owned,c=e.nodeID===e.selectedNodeID,d=a&&e.hovering||c,l=!e.visible||e.type!==o.Artillery&&e.type!==o.Fort?50:5,i=e.visible&&e.type!==o.Normal?e.type===o.Artillery||e.type===o.Factory?"double":"inset":"solid";return r.a.createElement("div",{className:"mapNode",onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,style:{width:"".concat(4,"vmin"),height:"".concat(4,"vmin"),borderStyle:i,borderWidth:"".concat(5/9/1,"vmin"),left:"calc(50% + ".concat((e.x-2)/1,"vmin)"),top:"calc(50% + ".concat((e.y-2)/1,"vmin)"),backgroundColor:d?n:t,color:d?t:n,borderColor:d?t:n,cursor:a&&e.hovering?"pointer":"default",borderRadius:l,textShadow:"\n                    -2px -2px 0 ".concat(d?n:t,",\n                    -2px  2px 0 ").concat(d?n:t,",\n                     2px -2px 0 ").concat(d?n:t,",\n                     2px  2px 0 ").concat(d?n:t,",\n                    -2px    0 0 ").concat(d?n:t,",\n                     2px    0 0 ").concat(d?n:t,",\n                       0 -2px 0 ").concat(d?n:t,",\n                       0  2px 0 ").concat(d?n:t,"\n                "),boxShadow:e.assigned?"0 0 30px #ffff00":""}},r.a.createElement("p",null,e.visible?e.army:null))},p=function(e){var t=Math.atan2(e.y2-e.y1,e.x2-e.x1),n=Math.sqrt((e.x2-e.x1)*(e.x2-e.x1)+(e.y2-e.y1)*(e.y2-e.y1));return r.a.createElement("div",{className:"mapConnection",style:{width:"".concat(n/1,"vmin"),height:"".concat(5/9/1,"vmin"),left:"calc(50% + ".concat((e.x1+Math.cos(t-Math.PI/2)*(5/9)/2)/1,"vmin)"),top:"calc(50% + ".concat((e.y1+Math.sin(t-Math.PI/2)*(5/9)/2)/1,"vmin)"),transform:"rotate(".concat(180*t/Math.PI,"deg)"),backgroundColor:e.visible?"#eeeeee":m[0]}})},v=function(e){return r.a.createElement("div",{className:"mapArmy",style:{width:"".concat(2,"vmin"),height:"".concat(2,"vmin"),left:"calc(50% + ".concat((e.x-1)/1,"vmin)"),top:"calc(50% + ".concat((e.y-1)/1,"vmin)"),backgroundColor:m[e.team],textShadow:"\n                    -1px -1px 0 ".concat(m[e.team],",\n                    -1px  1px 0 ").concat(m[e.team],",\n                     1px -1px 0 ").concat(m[e.team],",\n                     1px  1px 0 ").concat(m[e.team],",\n                    -1px    0 0 ").concat(m[e.team],",\n                     1px    0 0 ").concat(m[e.team],",\n                       0 -1px 0 ").concat(m[e.team],",\n                       0  1px 0 ").concat(m[e.team],"\n                ")}},r.a.createElement("p",null,e.count))},D=function(e,t,n){if(0===n||t.nodes[e].team===n)return!0;var o=!0,a=!1,r=void 0;try{for(var c,d=t.nodes[e].adj[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var l=c.value;if(t.nodes[l].team===n)return!0}}catch(i){a=!0,r=i}finally{try{o||null==d.return||d.return()}finally{if(a)throw r}}return!1};!function(e){e[e.SetNet=0]="SetNet",e[e.SetPlayerID=1]="SetPlayerID",e[e.SetSelectedNodeID=2]="SetSelectedNodeID",e[e.SetHoveredNodeID=3]="SetHoveredNodeID"}(u||(u={}));var I={net:{nodes:[],connections:[],armies:[]},playerID:-1,hoveredNodeID:-1,selectedNodeID:-1},f=function(e,t){switch(t.type){case u.SetNet:return{net:t.payload,playerID:e.playerID,hoveredNodeID:e.hoveredNodeID,selectedNodeID:e.selectedNodeID};case u.SetPlayerID:return{net:e.net,playerID:t.payload,hoveredNodeID:e.hoveredNodeID,selectedNodeID:e.selectedNodeID};case u.SetHoveredNodeID:return{net:e.net,playerID:e.playerID,hoveredNodeID:t.payload,selectedNodeID:e.selectedNodeID};case u.SetSelectedNodeID:var n=-1;return e.hoveredNodeID>=0&&e.hoveredNodeID!==e.selectedNodeID&&e.net.nodes[e.hoveredNodeID].team===e.playerID&&(n=e.hoveredNodeID),{net:e.net,playerID:e.playerID,hoveredNodeID:e.hoveredNodeID,selectedNodeID:n};default:throw new Error("Action type not found for mapReducer!")}},N=function(){var e=Object(a.useReducer)(f,I),t=Object(l.a)(e,2),n=t[0],c=t[1],d=Object(a.useRef)(null),i=Object(a.useCallback)((function(e){c({type:u.SetHoveredNodeID,payload:e})}),[]),m=Object(a.useCallback)((function(){c({type:u.SetHoveredNodeID,payload:-1})}),[]),N=Object(a.useCallback)((function(e){if(!(n.selectedNodeID<0||n.net.nodes[n.selectedNodeID].team!==n.playerID||null==d.current)){var t=n.net.nodes[n.selectedNodeID],a=e.which||e.keyCode;console.log(a);var r=!0;switch(String.fromCharCode(a)){case"A":d.current.emit("convert",t.id,o.Factory);break;case"S":d.current.emit("convert",t.id,o.PowerPlant);break;case"Z":d.current.emit("convert",t.id,o.Fort);break;case"X":d.current.emit("convert",t.id,o.Artillery);break;case"Q":if(n.hoveredNodeID<0||n.hoveredNodeID===t.id)break;d.current.emit("sendArmy",t.id,n.hoveredNodeID,10),r=!1;break;case"W":if(n.hoveredNodeID<0||n.hoveredNodeID===t.id)break;d.current.emit("sendArmy",t.id,n.hoveredNodeID,100),r=!1;break;case"E":if(n.hoveredNodeID===t.id)break;d.current.emit("assign",t.id,n.hoveredNodeID),r=!1}r&&c({type:u.SetSelectedNodeID,payload:-1})}}),[n]),h=Object(a.useCallback)((function(){console.log("called!"),c({type:u.SetSelectedNodeID})}),[]);return Object(a.useEffect)((function(){return document.addEventListener("keydown",N),function(){document.removeEventListener("keydown",N)}}),[N]),Object(a.useEffect)((function(){return document.addEventListener("mousedown",h),function(){document.removeEventListener("mousedown",h)}}),[h]),Object(a.useEffect)((function(){console.log("connecting!");var e=s.a.connect("http://192.168.50.167:3001");return d.current=e,e.on("playerID",(function(e){c({type:u.SetPlayerID,payload:e})})),e.on("network",(function(e){c({type:u.SetNet,payload:JSON.parse(e)})})),function(){e.disconnect(),d.current=null}}),[d]),r.a.createElement("div",{className:"map"},0===n.net.nodes.length?"Loading map...":n.playerID<0?"Waiting for server...":n.net.nodes.map((function(e){return r.a.createElement(y,{x:e.x,y:e.y,team:e.team,army:e.army,type:e.type,visible:D(e.id,n.net,n.playerID),hovering:n.hoveredNodeID===e.id,owned:e.team===n.playerID,nodeID:e.id,selectedNodeID:n.selectedNodeID,assigned:n.selectedNodeID>0&&n.net.nodes[n.selectedNodeID].assign===e.id,onMouseEnter:function(){i(e.id)},onMouseLeave:function(){m()},key:e.id})})).concat(n.net.connections.map((function(e){var t,o,a,c=Object(l.a)(e,2),d=c[0],i=c[1];return r.a.createElement(p,{x1:n.net.nodes[d].x,x2:n.net.nodes[i].x,y1:n.net.nodes[d].y,y2:n.net.nodes[i].y,visible:(t=[d,i],o=n.net,a=n.playerID,0===a||o.nodes[t[0]].team===a||o.nodes[t[1]].team===a),key:"".concat(d,"_").concat(i)})}))).concat(n.net.armies.map((function(e){var t=n.net.nodes[e.from],o=n.net.nodes[e.to];if(t.team!==n.playerID&&o.team!==n.playerID)return r.a.createElement(r.a.Fragment,null);var a=o.x-t.x,c=o.y-t.y,d=Math.sqrt(a*a+c*c),l=3+e.distance*(d-4-2)/d,i=Math.atan2(c,a);return r.a.createElement(v,{x:t.x+Math.cos(i)*l,y:t.y+Math.sin(i)*l,team:e.team,count:e.count,armyID:e.id,key:"army_".concat(e.id)})}))))};n(68);var h=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(N,null))};d.a.render(r.a.createElement(h,null),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.884d64a3.chunk.js.map