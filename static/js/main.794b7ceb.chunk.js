(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{31:function(e,o,t){e.exports=t(70)},36:function(e,o,t){},65:function(e,o){},68:function(e,o,t){},69:function(e,o,t){},70:function(e,o,t){"use strict";t.r(o);var n,r,a=t(0),c=t.n(a),d=t(29),i=t.n(d),m=(t(36),t(1)),l=t(30),s=t.n(l),u=function(e){var o=Object(a.useCallback)((function(){void 0!==e.socket&&e.socket.emit("createRoom",2,!1)}),[e.socket]),t=Object(a.useCallback)((function(o){void 0!==e.socket&&e.socket.emit("joinRoom",o.id)}),[e.socket]);if(void 0!==e.roomList){var n=e.roomList.map((function(e){return c.a.createElement("p",{onMouseDown:function(){t(e)}},e.name,": ",e.nPlayers," players / ",e.maxPlayers," max players / ",e.nSpectators," spectators")}));return c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{onMouseDown:function(){o()}},"Create Room!"),n)}return c.a.createElement("p",null,"Waiting to retrieve the room list from the server...")},v=t(2);!function(e){e[e.Neutral=0]="Neutral",e[e.Red=1]="Red",e[e.Blue=2]="Blue",e[e.Green=3]="Green",e[e.Yellow=4]="Yellow",e[e.Orange=5]="Orange",e[e.Purple=6]="Purple"}(n||(n={}));var p,y=(r={},Object(v.a)(r,n.Neutral,"#444444"),Object(v.a)(r,n.Red,"#DD0000"),Object(v.a)(r,n.Blue,"#0000DD"),Object(v.a)(r,n.Green,"#00DD00"),Object(v.a)(r,n.Yellow,"#DDDD00"),Object(v.a)(r,n.Orange,"#DD7700"),Object(v.a)(r,n.Purple,"#7700DD"),r);!function(e){e[e.SetSocket=0]="SetSocket",e[e.SetRoom=1]="SetRoom",e[e.SetPlayer=2]="SetPlayer",e[e.SetRoomList=3]="SetRoomList"}(p||(p={}));var f,S={socket:void 0,room:void 0,player:void 0,roomList:void 0},D=function(e,o){switch(o.type){case p.SetSocket:return{socket:o.socket,room:e.room,player:e.player,roomList:e.roomList};case p.SetRoom:return{socket:e.socket,room:o.room,player:e.player,roomList:e.roomList};case p.SetPlayer:return{socket:e.socket,room:e.room,player:o.player,roomList:e.roomList};case p.SetRoomList:return{socket:e.socket,room:e.room,player:e.player,roomList:o.roomList};default:throw new Error("Action type not found for clientStateReducer!")}};!function(e){e[e.SetNodeHoveredID=0]="SetNodeHoveredID",e[e.SetNodeSelectedID=1]="SetNodeSelectedID"}(f||(f={}));var I,k={nodeHoveredID:void 0,nodeSelectedID:void 0},b=function(e,o){switch(o.type){case f.SetNodeHoveredID:return{nodeHoveredID:o.nodeHoveredID,nodeSelectedID:e.nodeSelectedID};case f.SetNodeSelectedID:return{nodeHoveredID:e.nodeHoveredID,nodeSelectedID:o.nodeSelectedID};default:throw new Error("Action type not found for roomStateReducer!")}};!function(e){e[e.Normal=0]="Normal",e[e.Factory=1]="Factory",e[e.PowerPlant=2]="PowerPlant",e[e.Fort=3]="Fort",e[e.Artillery=4]="Artillery"}(I||(I={}));var h=function(e){var o=e.team===n.Neutral||function(e,o){if(e.team===o)return!0;var t=!0,n=!1,r=void 0;try{for(var a,c=e.adj[Symbol.iterator]();!(t=(a=c.next()).done);t=!0){if(a.value.team===o)return!0}}catch(d){n=!0,r=d}finally{try{t||null==c.return||c.return()}finally{if(n)throw r}}return!1}(e.node,e.team),t=e.team!==n.Neutral&&(void 0!==e.nodeSelected&&o||e.node.team===e.team),r=e.node===e.nodeSelected,a=e.node===e.nodeHovered,d=void 0!==e.nodeSelected&&e.nodeSelected.assign===e.node,i=o?y[e.node.team]:y[n.Neutral],m=o?"#eeeeee":y[n.Neutral],l=t&&a||r,s=!o||e.node.type!==I.Artillery&&e.node.type!==I.Fort?50:5,u=o&&e.node.type!==I.Normal?e.node.type===I.Artillery||e.node.type===I.Factory?"double":"inset":"solid";return c.a.createElement("div",{className:"mapNode",onMouseEnter:function(){void 0!==e.onMouseEnterNode&&e.onMouseEnterNode(e.node)},onMouseLeave:function(){void 0!==e.onMouseLeaveNode&&e.onMouseLeaveNode(e.node)},style:{width:"".concat(4,"vmin"),height:"".concat(4,"vmin"),left:"calc(50% + ".concat((e.node.x-2)/1,"vmin)"),top:"calc(50% + ".concat((e.node.y-2)/1,"vmin)"),borderStyle:u,borderWidth:"".concat(5/9/1,"vmin"),borderRadius:s,backgroundColor:l?m:i,color:l?i:m,borderColor:l?i:m,cursor:t&&a?"pointer":"default",textShadow:"\n                    -2px -2px 0 ".concat(l?m:i,",\n                    -2px  2px 0 ").concat(l?m:i,",\n                     2px -2px 0 ").concat(l?m:i,",\n                     2px  2px 0 ").concat(l?m:i,",\n                    -2px    0 0 ").concat(l?m:i,",\n                     2px    0 0 ").concat(l?m:i,",\n                       0 -2px 0 ").concat(l?m:i,",\n                       0  2px 0 ").concat(l?m:i,"\n                "),boxShadow:d?"0 0 30px #ffff00":""}},c.a.createElement("p",null,o?e.node.troops:null))},N=function(e){var o=e.team===n.Neutral||e.node1.team===e.team||e.node2.team===e.team,t=e.node2.x-e.node1.x,r=e.node2.y-e.node1.y,a=Math.atan2(r,t),d=Math.sqrt(t*t+r*r),i=e.node1.x+Math.cos(a-Math.PI/2)*(5/9)/2,m=e.node1.y+Math.sin(a-Math.PI/2)*(5/9)/2;return c.a.createElement("div",{className:"mapEdge",style:{width:"".concat(d/1,"vmin"),height:"".concat(5/9/1,"vmin"),left:"calc(50% + ".concat(i/1,"vmin)"),top:"calc(50% + ".concat(m/1,"vmin)"),transform:"rotate(".concat(180*a/Math.PI,"deg)"),backgroundColor:o?"#eeeeee":y[n.Neutral]}})},g=(t(68),function(e){var o=void 0!==e.nodeHoveredID?e.map.nodes[e.nodeHoveredID]:void 0,t=void 0!==e.nodeSelectedID?e.map.nodes[e.nodeSelectedID]:void 0,n=e.map.nodes.map((function(n){return c.a.createElement(h,{node:n,team:e.team,nodeHovered:o,nodeSelected:t,onMouseEnterNode:e.onMouseEnterNode,onMouseLeaveNode:e.onMouseLeaveNode,key:"node_".concat(n.id)})})),r=e.map.edges.map((function(o){var n=Object(m.a)(o,2),r=n[0],a=n[1];return c.a.createElement(N,{node1:r,node2:a,team:e.team,nodeSelected:t,key:"edge_".concat(r.id,"_").concat(a.id)})}));return c.a.createElement(c.a.Fragment,null,n.concat(r))}),x=function(e){var o=e.army.from,t=e.army.to;if(e.team!==n.Neutral&&o.team!==e.team&&t.team!==e.team)return c.a.createElement(c.a.Fragment,null);var r=t.x-o.x,a=t.y-o.y,d=Math.sqrt(r*r+a*a),i=3+e.army.distance*(d-4-2)/d,m=Math.atan2(a,r),l=o.x+Math.cos(m)*i,s=o.y+Math.sin(m)*i,u=y[e.army.team];return c.a.createElement("div",{className:"mapArmy",style:{width:"".concat(2,"vmin"),height:"".concat(2,"vmin"),left:"calc(50% + ".concat((l-1)/1,"vmin)"),top:"calc(50% + ".concat((s-1)/1,"vmin)"),backgroundColor:u,textShadow:"\n                    -1px -1px 0 ".concat(u,",\n                    -1px  1px 0 ").concat(u,",\n                     1px -1px 0 ").concat(u,",\n                     1px  1px 0 ").concat(u,",\n                    -1px    0 0 ").concat(u,",\n                     1px    0 0 ").concat(u,",\n                       0 -1px 0 ").concat(u,",\n                       0  1px 0 ").concat(u,"\n                ")}},c.a.createElement("p",null,e.army.troops))},E=function(e){var o=e.game.armies.map((function(o){return c.a.createElement(x,{army:o,team:e.team,key:"army_".concat(o.id)})}));return c.a.createElement("div",{className:"map"},c.a.createElement(g,{map:e.game.map,team:e.team,nodeHoveredID:e.nodeHoveredID,nodeSelectedID:e.nodeSelectedID,onMouseEnterNode:e.onMouseEnterNode,onMouseLeaveNode:e.onMouseLeaveNode}),o)},w=function(e){var o=Object(a.useReducer)(b,k),t=Object(m.a)(o,2),r=t[0],d=t[1],i=Object(a.useCallback)((function(e){d({type:f.SetNodeHoveredID,nodeHoveredID:e.id})}),[d]),l=Object(a.useCallback)((function(){d({type:f.SetNodeHoveredID,nodeHoveredID:void 0})}),[d]),s=Object(a.useCallback)((function(o){if(void 0!==e.socket&&void 0!==e.room&&void 0!==e.room.game&&void 0!==e.player&&void 0!==r.nodeSelectedID){var t=e.room.game.map.nodes[r.nodeSelectedID];if(void 0!==t&&t.team===e.player.team){var n=o.which||o.keyCode,a=!0;switch(String.fromCharCode(n)){case"A":e.socket.emit("build",r.nodeSelectedID,I.Factory);break;case"S":e.socket.emit("build",r.nodeSelectedID,I.PowerPlant);break;case"Z":e.socket.emit("build",r.nodeSelectedID,I.Fort);break;case"X":e.socket.emit("build",r.nodeSelectedID,I.Artillery);break;case"Q":if(void 0===r.nodeHoveredID||r.nodeHoveredID===r.nodeSelectedID)break;e.socket.emit("sendArmy",r.nodeSelectedID,r.nodeHoveredID,10),a=!1;break;case"W":if(void 0===r.nodeHoveredID||r.nodeHoveredID===r.nodeSelectedID)break;e.socket.emit("sendArmy",r.nodeSelectedID,r.nodeHoveredID,100),a=!1;break;case"E":if(r.nodeHoveredID===r.nodeSelectedID)break;e.socket.emit("assign",r.nodeSelectedID,void 0!==r.nodeHoveredID?r.nodeHoveredID:-1),a=!1}a&&d({type:f.SetNodeSelectedID,nodeSelectedID:void 0})}}}),[e,r,d]),u=Object(a.useCallback)((function(){if(void 0!==r.nodeHoveredID&&void 0!==e.room&&void 0!==e.room.game&&e.player.team!==n.Neutral){var o=e.room.game.map.nodes[r.nodeHoveredID];if(void 0!==o&&o.team===e.player.team)return void d({type:f.SetNodeSelectedID,nodeSelectedID:o.id})}d({type:f.SetNodeSelectedID,nodeSelectedID:void 0})}),[e,r,d]);return Object(a.useEffect)((function(){return document.addEventListener("keydown",s),function(){document.removeEventListener("keydown",s)}}),[s]),Object(a.useEffect)((function(){return document.addEventListener("mousedown",u),function(){document.removeEventListener("mousedown",u)}}),[u]),void 0!==e.room.game?c.a.createElement(E,{game:e.room.game,team:e.player.team,nodeHoveredID:r.nodeHoveredID,nodeSelectedID:r.nodeSelectedID,onMouseEnterNode:i,onMouseLeaveNode:l}):(e.room.players.length===e.room.summary.maxPlayers&&e.player.id===e.room.players[0].id&&e.socket.emit("startRoom"),c.a.createElement("p",null,"Waiting for at least ",e.room.summary.maxPlayers," players... (currently at ",e.room.summary.nPlayers,"!) ",c.a.createElement("br",null),"Perhaps invite friends or open up a new tab of this game?"))},H=function(){var e=Object(a.useReducer)(D,S),o=Object(m.a)(e,2),t=o[0],n=o[1];return Object(a.useEffect)((function(){console.log("connecting!");var e=s.a.connect("https://riskystrats.herokuapp.com");return n({type:p.SetSocket,socket:e}),e.on("roomList",(function(e){var o=JSON.parse(e);n({type:p.SetRoomList,roomList:o})})),e.on("playerData",(function(e){var o=JSON.parse(e);n({type:p.SetPlayer,player:o})})),e.on("roomData",(function(e){var o=JSON.parse(e),t=null!==o?function(e){if(void 0===e.game)return{game:void 0,players:e.players,spectators:e.spectators,summary:e.summary};var o=e.game.map,t=o.nodes.map((function(e){return{x:e.x,y:e.y,id:e.id,adj:[],team:e.team,troops:e.troops,type:e.type,assign:void 0}})),n=!0,r=!1,a=void 0;try{for(var c,d=o.nodes[Symbol.iterator]();!(n=(c=d.next()).done);n=!0){var i=c.value,l=t[i.id],s=!0,u=!1,v=void 0;try{for(var p,y=i.adj[Symbol.iterator]();!(s=(p=y.next()).done);s=!0){var f=p.value;l.adj.push(t[f])}}catch(D){u=!0,v=D}finally{try{s||null==y.return||y.return()}finally{if(u)throw v}}l.assign=i.assign>=0?t[i.assign]:void 0}}catch(D){r=!0,a=D}finally{try{n||null==d.return||d.return()}finally{if(r)throw a}}var S=e.game.armies.map((function(e){return{from:t[e.from],to:t[e.to],troops:e.troops,distance:e.distance,team:e.team,id:e.id}}));return{game:{map:{nodes:t,edges:o.edges.map((function(e){var o=Object(m.a)(e,2),n=o[0],r=o[1];return[t[n],t[r]]}))},armies:S},players:e.players,spectators:e.spectators,summary:e.summary}}(o):void 0;n({type:p.SetRoom,room:t})})),function(){e.disconnect(),n({type:p.SetSocket,socket:void 0})}}),[n]),void 0!==t.socket&&void 0!==t.player&&void 0!==t.room?c.a.createElement(w,{socket:t.socket,player:t.player,room:t.room}):c.a.createElement(u,{socket:t.socket,roomList:t.roomList})};t(69);var L=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(H,null))};i.a.render(c.a.createElement(L,null),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.794b7ceb.chunk.js.map